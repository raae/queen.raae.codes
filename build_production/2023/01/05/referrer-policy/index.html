<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="canonical" href="https://queen.raae.codes/2023/01/05/referrer-policy">
        <meta name="description" content="Ahoy, seasoned JavaScript developers and daring dev pirates! Join our swashbuckling crew as we embark on thrilling treasure hunts unraveling the secrets of HTML, CSS, and JavaScript, all while having a blast!">
        <title>Have you checked your Referrer-Policy?</title>
                <link rel="stylesheet" href="/assets/build/assets/main-HrG164mN.css">
        <script defer type="module" src="/assets/build/assets/main-l0sNRNKZ.js"></script>
    </head>
    <body class="text-gray-900 font-sans antialiased">
        <article class="max-w-3xl mx-auto px-4 py-8">
    <header class="mb-8">
        <h1 class="text-4xl font-bold text-brown-900 mb-4">Have you checked your Referrer-Policy?</h1>

        
                    <div class="mt-4 flex flex-wrap gap-2">
                                    <span class="px-3 py-1 bg-brown-100 text-brown-800 rounded-full text-sm">
                        analytics
                    </span>
                            </div>
            </header>

    <div class="prose prose-lg prose-brown max-w-none">
        <p><a href="https://pruneyourfollows.com">Prune your follows</a> initial build was sponsored by Xata. As part of the agreement, the site has a "powered by Xata" notice on every page linking to <a href="https://xata.io/">xata.io</a>, in addition to a link to my site.</p>

<p>Looking at my our analytics, I found it weird that no one was clicking through from <a href="https://pruneyourfollows.com/">pruneyourfollows.com</a> to <a href="https://queen.raae.codes/">queen.raae.codes</a> or vice versa.</p>

<p>As I imagine tracking traffic from PYF is part of Xata's evaluation of our collab, I got a little worried üò¨</p>

<p>Turns out the default Referrer-Policy is <code>same-origin</code> for Gatsby Cloud, Netlify, and probably most other similar platforms.</p>

<blockquote>
  <p><code>same-origin</code>: Send the origin, path, and query string for same-origin requests. Don't send the Referer header for cross-origin requests.
  <cite><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">mdn web docs</a></cite></p>
</blockquote>

<p>The only referrals tracked on for example, queen.raae.codes, were from itself to itself ü§¶‚Äç‚ôÄÔ∏è</p>

<p>After reading <a href="https://web.dev/referrer-best-practices">Referer and Referrer-Policy best practices</a> from web.dev I landed on using <code>strict-origin-when-cross-origin</code>.</p>

<p>It will send along the origin (<code>https://pruneyourfollows.com</code>) but not the full URL (<code>https://pruneyourfollows.com/app?example=possible-secret</code>).</p>

<h2>How to set the Referrer-Policy on Gatsby Cloud</h2>

<p>To make <code>strict-origin-when-cross-origin</code> the policy across the board configure the <code>gatsby-plugin-gatsby-cloud</code> like so:</p>

<pre><code class="language-js">module.exports = {
  plugins: [
    {
      resolve: `gatsby-plugin-gatsby-cloud`,
      options: {
        headers: {
          "/*": ["Referrer-Policy: strict-origin-when-cross-origin"],
        },
      },
    },
  ],
};
</code></pre>

<p>And voila, I finally saw referrer information from <a href="https://pruneyourfollows.com/">pruneyourfollows.com</a> to <a href="https://queen.raae.codes/">queen.raae.codes</a> and vice versa.</p>

<p><a href="https://app.usefathom.com/share/lfdkntld/pruneyourfollows.com"><img src="referrer-policy.jpg" alt="Fathom analytics dashboard for Prune your follows" /></a></p>

<p>&nbsp;</p>

<p>All the best,\
Queen Raae</p>

<p>&nbsp;</p>

<p>PS. Since we do not have access to Xata's analytics, we would also like to track clicks on their link on our side, and we'll do that on tonight's treasure hunt <a href="https://www.youtube.com/watch?v=SftxLYjW_ZQ">Track outgoing links with Fathom for Prune your follows</a>.</p>
    </div>
</article>
    </body>
</html>
