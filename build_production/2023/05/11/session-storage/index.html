<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="canonical" href="https://queen.raae.codes/2023/05/11/session-storage">
        <meta name="description" content="Ahoy, seasoned JavaScript developers and daring dev pirates! Join our swashbuckling crew as we embark on thrilling treasure hunts unraveling the secrets of HTML, CSS, and JavaScript, all while having a blast!">
        <title>Keeping things around until the session ends</title>
                <link rel="stylesheet" href="/assets/build/assets/main-BZO06M8j.css">
        <script defer type="module" src="/assets/build/assets/main-l0sNRNKZ.js"></script>
    </head>
    <body class="text-gray-900 font-sans antialiased">
        <article class="max-w-3xl mx-auto px-4 py-8">
    <header class="mb-8">
        <h1 class="text-4xl font-bold text-brown-900 mb-4">Keeping things around until the session ends</h1>

        
                    <div class="mt-4 flex flex-wrap gap-2">
                                    <span class="px-3 py-1 bg-brown-100 text-brown-800 rounded-full text-sm">
                        sessionStorage
                    </span>
                            </div>
            </header>

    <div class="prose prose-lg prose-brown max-w-none">
        <p>As mentioned when talking about <a href="/2023-05-06-url-search-params/">search params</a>, an <a href="http://www.outseta.com?via=queen">Outseta</a> customer wanted to pass along the UTM search params to the Outseta SignUp widget so that a visitor who came in through <em>https://example.com?utm_source=facebook&amp;utm_medium=paid_social&amp;utm_campaign=summer_sale</em> gets attributed to the summer sale paid Facebook ad.</p>

<p>The vistor might not sign up at the first page they land on, so it makes sense to keep the UTM search params around for the entirety of the session.</p>

<p>Vanilla JS again has our backs:</p>

<pre><code class="language-js">var params = new URL(window.location).searchParams;
var utmSource = params.get("utm_source");
var utmCampaign = params.get("utm_campaign");
var utmMedium = params.get("utm_medium");

if (UtmSource || UtmCampaign || UtmMedium) {
  try {
    sessionStorage.setItem("UtmSource", utmSource);
    sessionStorage.setItem("UtmCampaign", utmCampaign);
    sessionStorage.setItem("UtmMedium", utmMedium);
  } catch (error) {
    console.warn("Could not save UTM params to session storage");
  }
}
</code></pre>

<p>The try block is essential because turning off cookies in a browser also disables session storage as it can be used for the same purposes (tracking people) as you see here. So you want to make sure you handle that.</p>

<p>In addition, if you add this script to every page, the values will be overridden by empty strings on subsequent page visits. Therefore we add that if statement to ensure we have all the values we expect a visitor landing on a page from our campaign to have. Make sure to tweak this to your use case!</p>

<p>&nbsp;</p>

<p>All the best,\
Queen Raae</p>
    </div>
</article>
    </body>
</html>
