<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="canonical" href="https://queen.raae.codes/2022/12/18/social-proof">
        <meta name="description" content="Ahoy, seasoned JavaScript developers and daring dev pirates! Join our swashbuckling crew as we embark on thrilling treasure hunts unraveling the secrets of HTML, CSS, and JavaScript, all while having a blast!">
        <title>Source app usage for social proof on a Gatsby website</title>
                <link rel="stylesheet" href="/assets/build/assets/main-BZO06M8j.css">
        <script defer type="module" src="/assets/build/assets/main-l0sNRNKZ.js"></script>
    </head>
    <body class="text-gray-900 font-sans antialiased">
        <article class="max-w-3xl mx-auto px-4 py-8">
    <header class="mb-8">
        <h1 class="text-4xl font-bold text-brown-900 mb-4">Source app usage for social proof on a Gatsby website</h1>

        
            </header>

    <div class="prose prose-lg prose-brown max-w-none">
        <p>On this week's <a href="https://youtu.be/qAyaQaPIQCA">unauthorized and rum-fueled treasure hunt</a> in the sharky waters around the Gatsby we added we added usage stats to <a href="https://pruneyourfollows.com/">Prune your Follows</a>.</p>

<p><img src="./social-proof-section.png" alt="Social proof section" /></p>

<h2>The Why</h2>

<p>It's one way to show "social proof". Other ways are testimonials, reviews, the little avatars that are also present in the screenshot above, and more. Its purpose: Show potential users that it will be okay. Loads of people have already trusted us!</p>

<h2>The How</h2>

<p>1️⃣ We queried Xata, our serverless database, for aggregated data,\
2️⃣ created a Gatsby data node to hold the information,\
3️⃣ and used a static Gatsby query to get hold of the information in our component.</p>

<pre><code class="language-js">// File: /.gatsby-node.js

exports.sourceNodes = async (gatsbyUtils) =&gt; {
  const { reporter, actions, createNodeId, createContentDigest } = gatsbyUtils;
  const { createNode } = actions;

  // 1️⃣ Query Xata
  const result = await xata.db.accounts.aggregate({
    unfollowsTotal: {
      count: {
        filter: {
          //There is some older test data in there
          unfollowed: { $ge: new Date("2022-11-03") },
        },
      },
    },
    usersTotal: {
      uniqueCount: {
        column: "followed_by",
      },
    },
  });

  const statsData = {
    unfollowedCount: result.aggs.unfollowsTotal,
    userCount: result.aggs.usersTotal,
  };

  // 2️⃣ Create Node
  createNode({
    id: createNodeId("statistics"),
    ...statsData,
    internal: {
      type: "Statistics",
      contentDigest: createContentDigest(statsData),
    },
  });
};
</code></pre>

<pre><code class="language-jsx">// File: ./src/domain/marketing/Stat.js

import React from "react";
import { useStaticQuery, graphql } from "gatsby";

export function Stats() {
  // 3️⃣ Use in component
  const data = useStaticQuery(graphql`
    query {
      statistics {
        unfollowedCount
        userCount
      }
    }
  `);

  return (
    &lt;section&gt;
      Users: {data.statistics.userCount}
      Unfollows: {data.statistics.unfollowedCount}
    &lt;/section&gt;
  );
}
</code></pre>

<p>Check out the pull request for the complete example, including the tailwind design for the component.</p>

<p>All the best,\
Queen Raae</p>
    </div>
</article>
    </body>
</html>
