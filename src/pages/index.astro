---
import BaseLayout from "../layouts/BaseLayout.astro";
import SiteHeader from "../components/SiteHeader.astro";
import PageSection from "../components/PageSection.astro";
import PageSectionHeader from "../components/PageSectionHeader.astro";
import Prose from "../components/Prose.astro";
import Posts from "../components/Posts.astro";
import Newsletter from "../components/Newsletter.astro";
import { getAllPosts } from "../lib/posts";
import { getEntry } from "astro:content";

// Get landing page content
const landing = await getEntry("landing", "index");
const { Content } = await landing.render();

// Get latest posts
const allPosts = await getAllPosts();
const latestPosts = allPosts.slice(0, 7);

const { badge, title } = landing.data;
---

<BaseLayout title={title}>
  <SiteHeader />
  <main class="pb-12">
    <!-- Header Section -->
    <PageSection component="header">
      <PageSectionHeader badge={badge} hLevel={1} class="opacity-0" />
      <Prose>
        <Content />
      </Prose>
    </PageSection>

    <!-- Newsletter Section -->
    <PageSection>
      <Newsletter />
    </PageSection>

    <!-- Latest Posts Section -->
    <PageSection>
      <PageSectionHeader title="Latest Posts" titlePath="/posts/" />
      <Posts posts={latestPosts} more class="mt-8" />
    </PageSection>
  </main>
</BaseLayout>
