---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const allTalks = await getCollection('talks');
const talks = allTalks.filter(talk => talk.id !== 'index.md');

// Sort talks by date (newest first)
const sortedTalks = talks.sort((a, b) => {
  const dateA = a.id.match(/(\d{4})-(\d{2})-(\d{2})/);
  const dateB = b.id.match(/(\d{4})-(\d{2})-(\d{2})/);
  if (dateA && dateB) {
    return new Date(`${dateB[1]}-${dateB[2]}-${dateB[3]}`).getTime() - new Date(`${dateA[1]}-${dateA[2]}-${dateA[3]}`).getTime();
  }
  return 0;
});
---

<BaseLayout
  title="Bring joy and knowledge to your next event"
  description="Are you planning a brown bag lunch? Internal or external conference? On the topic of web development, the Jamstack or Gatsby specifically?"
>
  <div class="min-h-screen px-4 py-8 max-w-4xl mx-auto">
    <header class="mb-12">
      <div class="text-sm text-brown-700 uppercase tracking-wide mb-2">Speaker</div>
      <h1 class="text-4xl md:text-5xl font-bold mb-4">Bring joy and knowledge to your next event</h1>
      <p class="text-lg text-brown-700 mb-6">
        Are you planning a brown bag lunch? Internal or external conference? On the topic of web development, the Jamstack or Gatsby specifically?
      </p>
      <div class="prose prose-brown max-w-none mb-8">
        <p>
          Imagine having an energetic person speaking at your next event. One who brings almost 20 years of web development joy into her talks. Who can live code if that's your audience's jam!
        </p>
      </div>
      <div class="border-4 border-dashed border-amber-500 p-6">
        <h2 class="text-2xl font-bold mb-4">Book a talk</h2>
        <p class="mb-4">From 1.750 USD (+ travel expenses) for a 20-40 min standard talk</p>
        <p class="text-sm text-brown-700 mb-4">Other prices apply to custom talks and workshops.</p>
        <a
          href="https://forms.reform.app/iXD8KR/book-talk/f9wr7p"
          class="inline-block bg-amber-500 text-brown-900 px-6 py-3 rounded font-bold hover:bg-amber-600 transition"
        >
          Book a talk →
        </a>
      </div>
    </header>

    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-6">Some of my past and future speaking engagements</h2>
      <div class="space-y-8">
        {sortedTalks.map((talk) => {
          const dateMatch = talk.id.match(/(\d{4})-(\d{2})-(\d{2})/);
          const dateStr = dateMatch ? `${dateMatch[1]}-${dateMatch[2]}-${dateMatch[3]}` : '';
          const formattedDate = dateMatch ? new Date(`${dateMatch[1]}-${dateMatch[2]}-${dateMatch[3]}`).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          }) : '';

          return (
            <article class="border-l-4 border-amber-500 pl-4 py-2">
              <a href={`/speaker/${talk.slug}/`} class="block group">
                <div class="text-sm text-brown-700 mb-1">{formattedDate}</div>
                <h3 class="text-2xl font-bold mb-2 group-hover:text-teal-900 transition">{talk.data.title}</h3>
                {talk.data.event && (
                  <p class="text-brown-700">
                    {talk.data.eventUrl ? (
                      <a href={talk.data.eventUrl} target="_blank" rel="noreferrer" class="hover:text-teal-900">
                        {talk.data.event} ↗
                      </a>
                    ) : (
                      talk.data.event
                    )}
                  </p>
                )}
                {talk.data.recording && (
                  <a
                    href={talk.data.recording}
                    target="_blank"
                    rel="noreferrer"
                    class="inline-block mt-2 text-sm bg-brown-200 text-brown-900 px-3 py-1 rounded hover:bg-brown-300 transition"
                  >
                    Watch recording ↗
                  </a>
                )}
              </a>
            </article>
          );
        })}
      </div>
      <div class="mt-8">
        <a
          href="https://youtube.com/playlist?list=PL9W-8hhRoLoOPHYk1gtkvTSVNV1qleLWy"
          target="_blank"
          rel="noreferrer"
          class="inline-block bg-brown-700 text-brown-50 px-6 py-3 rounded hover:bg-brown-800 transition"
        >
          and more on YouTube ↗
        </a>
      </div>
    </section>

    <section class="p-6 border-4 border-dashed border-amber-500">
      <h2 class="text-2xl font-bold mb-4">Newsletter</h2>
      <p class="mb-4">Subscribe to get emails about web development and pirate adventures!</p>
      <div class="text-center">
        <a href="/subs/" class="inline-block bg-amber-500 text-brown-900 px-6 py-3 rounded font-bold hover:bg-amber-600 transition">
          Sign up for the newsletter
        </a>
      </div>
    </section>
  </div>
</BaseLayout>
